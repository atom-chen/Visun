syntax = "proto3";
package drbjl;
option java_package = "com.beiyou.game.proto";
option java_outer_classname = "GameProto";

// 统一回复数据格式
message Reply
{
    int32 code = 1;
    string msg = 2;
}

// 数组
message IntArr
{
    repeated int32 arr= 1;
}

message Player
{
    int32 userId = 1;
    string nickName = 2;
    string headImg = 3;
    int32 sex = 4;
    repeated int32 betCoin = 5;
    double currentScore = 6;
    double totalScore = 7;
    double revenue = 8;
    double coin = 9;
    int32 lastRoundBet = 10;
    int32 curTableIndex = 11;
}

message SimpleTable
{
    string tableId = 1;
    repeated IntArr winPosRecord = 2;
}

message SubTable
{
    int32 index = 1;
    int32 state = 2;
    repeated int32 cardA = 3;
    repeated int32 cardB = 4;
    int32 numA = 5;
    int32 numB = 6;
    repeated int32 totalBet = 7;
    repeated int32 winPoss = 8;
    repeated IntArr winPosRecord = 9; 
}

message TableInfo
{
    string tableId = 1;      
    string seq = 2;  
    int32 currentRound = 3;
    int32 gameId = 4;         
    int32 gameNo = 5;
    int32 minLimit = 6;
    repeated int32 maxLimit = 7;
    repeated int32 allowBet = 8;
    repeated double mult = 9;
    repeated SubTable subTables = 10;
}

message FreeHandInfo
{
    repeated int32 cardA = 1;
    repeated int32 cardB = 2;
    int32 numA = 3;
    int32 numB = 4;
    repeated int32 winPoss = 5;
}

/* ------------------------------------------------------------- *
 * ------------------------------------------------------------- *
 * -------------  如果发生错误则会回复 Reply 结构  --------------- *
 * ------------------------------------------------------------- *
 *---------------------------------------------------------------*/

// 此游戏未注册消息 但是包含此消息实现
// 消息类                    消息号                                    注册此消息游戏
// BindGameNoHandler        BIND_GAME_NO_HANDLER =2002                  骰宝
// GetAllUserHandler        GETUSERLIST_REQ  = 2020                      奔驰宝马，龙虎，飞禽走兽
// GetRomeListHandler       GET_ROME_LIST = 20004                       三公，十三水，骰宝

// common 层消息

//GETTABLELIST_REQ      = 2001
message C2S_GetTableList
{
    string sid = 1;
}

//GETTABLELIST_RESP     =2002
message S2C_GetTableList
{
    repeated SimpleTable tableList = 1;
}

//FREEHANDS_REQ     =2003
message C2S_FreeHands
{
    int32 tableIndex = 1;
    int32 rounds = 2;
}

//2004
message S2C_FreeHands
{
    int32 tableIndex = 1;
    repeated FreeHandInfo freeHandInfo = 2;
}

//DEALCARD_REQ      =2005
message C2S_DealCard
{
    int32 tableIndex = 1;
    bool isRepeat = 2;
    bool isDouble = 3; 
}

//DEALCARD_RESP     =2006 
message S2C_DealCard
{
    int32 tableIndex = 1;
    Player player = 2;
    TableInfo tableInfo = 3;
    Reply ret = 4;
}

// BET_REQ                             = 2010;
message C2S_Bet
{
    int32 tableIndex = 1;
    int32 pos = 2;          // 下注位置
    int32 value = 3;        // 下注金额
}

//2011
message S2C_Bet
{
    int32 tableIndex = 1;
    Player player = 2;
    int32 pos = 3;          // 下注位置
    int32 value = 4;        // 下注金额
    Reply ret = 5;
}

// RESET_SUBTABLE_REQ    = 2012
message C2S_ResetSubTable
{
    int32 tableIndex = 1;
}

//RESET_SUBTABLE_RESP   =2013
message S2C_ResetSubTable
{
    int32 tableIndex = 1;
    Reply ret = 2;
}

// UNDO_BET_REQ          = 2026
message C2S_UndoBet
{
    int32 tableIndex = 1;
}

//2027
message S2C_UndoBet
{
    int32 tableIndex = 1;
    Player player = 2;
    repeated int32 bet = 3;
    Reply ret = 4;
}

// USER_RECONNECT_REQ        = 2030
message C2S_Reconnect
{
    int32 userId = 1;
}

// PUSH_USER_RECONNECT_RESP = 2031
// PUSH_RECONNECT_QUIT_RESP = 2035 房间不存在发送此消息号 ------- 返回大厅
// PUSH_RECONNECT_DATA_RESP = 2033 重连数据

//2031
message S2C_Reconnect
{
    Reply ret = 1;
}

//2033
message S2C_PushReconnectData
{
    Player player = 1; 
    TableInfo tableInfo = 2;
    string token = 3;
    Reply ret = 4;
}

//2035
message S2C_PushReconnectQuit
{
    int32 userId = 1; 
}


// USER_QUIT_REQ             =2044
message C2S_UserQuit
{
}

//2045
message S2C_UserQuit
{
    int32 userId = 1;
}

//2047
message S2C_UserExit
{
   int32 userId = 1;
}

//2080
message C2S_UserOnback
{
    Reply ret = 1;
    int32 onback = 2;
}

//2081
message S2C_UserOnback
{
    int32 userId = 1;
    Reply ret = 2;
}

//3000
message C2S_ForceOffline
{
    int32 userId = 1;
}

//3001
message S2C_forceOffline
{
    Reply ret = 1;
}

//3003
message S2C_DelayQuitOffline
{
    int32 userId = 1;
}

// JOIN_COIN_TABLE_REQ       =20006
message C2S_JoinTable
{
    string sid= 1;
    int32 tableIndex = 2;
}

//20007
message S2C_JoinTable
{
    TableInfo tableInfo = 1;
    Player player = 2;
    Reply ret = 3;
}

// 20010
message C2S_DelayCheck
{
}

//20011
message S2C_DelayCheck
{
    Reply ret = 1;
}


//30002
message C2S_NoticePush
{
}

//30003
message S2C_NoticePush
{
    Reply ret = 1;
}

// SET_SPECIAL_CARD_REQ       = 10000009;
message C2S_GetSpecialCard
{
    string data = 1;
}

//10000010
message S2C_GetSpecialCard
{
    Reply ret = 1;
}

//所有请求接口
message Request {
    enum CMD 
    {
        UNKNOWN                             = 0;

        //刷新游戏金币
        HALL_REFRESH_COIN                   = 100;

        //后台手动踢出用户
        ADMIN_KICKEDOUT                     = 200;

        //推送延时时间
        PUSH_REMAINTIME_MSG                 = 20015;

        //获取桌子列表
        GETTABLELIST_REQ                    = 2001;
        GETTABLELIST_RESP                   = 2002;

        //飞牌
        FREEHANDS_REQ                       = 2003;
        FREEHANDS_RESP                      = 2004;

        //发牌
        DEALCARD_REQ                        = 2005;
        DEALCARD_RESP                       = 2006;

        //下注
        BET_REQ                             = 2010;
        BET_RESP                            = 2011;

        //重置子牌桌
        RESET_SUBTABLE_REQ                  = 2012;
        RESET_SUBTABLE_RESP                 = 2013;

        //撤销投注
        UNDO_BET_REQ                         = 2026;
        UNDO_BET_RESP                        = 2027;

        //重新连接
        USER_RECONNECT_REQ                  = 2030;       
        USER_RECONNECT_RESP                 = 2031;

        //推送玩家重连数据
        PUSH_RECONNECT_DATA_MSG             = 2033;

        //通知玩家重连到大厅
        PUSH_RECONNECT_QUIT_MSG             = 2035;

        //玩家退出
        USER_QUIT_REQ                       = 2044;
        USER_QUIT_RESP                      = 2045;

        //推送玩家退出
        PUSH_USER_EXIT                      = 2047;

        //玩家退到后台
        USER_ONBACK_REQ                     = 2080;
        USER_ONBACK_RESP                    = 2081;

        //通知刷新金币
        PUSH_REFRESH_COIN                   = 2501;

        //强制下线请求                       
        FORCE_OFFLINE_REQ                   = 3000;
        FORCE_OFFLINE_RESP                  = 3001;

        //推送超时下线通知
        PUSH_DELAYQUIT_OFFLINE_MSG          = 3003;

        //推送踢出消息
        PUSH_KICKEDOUT_MSG                  = 4001;


         //加入桌子
        JOIN_COIN_TABLE_REQ                 = 20006;        
        JOIN_COIN_TABLE_RESP                = 20007;

        //客户端延时检测
        DELAY_CHECK_REQ                     = 20010;    //客户端延时检测
        DELAY_CHECK_RESP                    = 20011;

        //游戏服请求广播
        NOTICE_PUSH_REQ                     = 30002;
        NOTICE_PUSH_RESP                    = 30003;

        //配牌
        SET_SPECIAL_CARD_REQ                = 10000009;
        SET_SPECIAL_CARD_RESP               = 10000010;
    }

    CMD   cmd                           = 1;      //访问接口
    C2S_Bet bet			                = 11;	
    C2S_JoinTable joinTable      		= 12;     	  
    C2S_NoticePush noticePush			= 13;	 
    C2S_Reconnect reconnect				= 14;	  
    C2S_UserOnback userOnback			= 15;	  
    C2S_UserQuit userQuit				= 16;	
    C2S_GetTableList getTableList       = 17;
    C2S_FreeHands freeHands             = 18;
    C2S_DealCard dealCard               = 19;
    C2S_UndoBet undoBet                 = 20;
    C2S_ResetSubTable resetSubTable     = 21;
    C2S_GetSpecialCard getSpecialCard   = 22;

	//extensions 500 to 1000;
}

//所有应答接口
message Response {
    enum ErrorCode {
        NO_ERROR                                            = 0;       
        UNKNOWN_ERROR                                       = 400;                      //未知错误
        USER_LOGIN_ERROR                                    = 3001;                     // token失效,登录校验失败
        CHANNELID_GAMENO_ERROR                              = 3003;                     // channelId或gameNo错误
        HAS_INTABLE                                         = 3006;                     // 加入失败..用户已经在牌桌中
        JOIN_TABLE_ERROR                                    = 3007;                     // 加入牌桌失败
        TABLE_NOT_FIND_ERROR								= 3008;						// --牌桌不存在  
        NOT_IN_TABLE                                        = 3011;                     // --未加入此房间
        TABLE_QUIT_ERROR                                    = 3013;                     // 玩家退出异常
        RECONNET_ERROR                                      = 3025;                     // 重连错误
        USER_ONBACK_ERROR                                   = 3056;                     // 用户退后台消息
        DELAY_CHECK_ERROR                                   = 3071;                     //延时检测异常

        BETCOIN_LIMIT                                       = 3076;                     // --不可以超出下注上限~
        USER_BET_ERROR                                      = 3077;                     // --下注错误，不在下注状态
        USER_BETCOIN_ERROR                                  = 3078;                     // --下注金额错误
        USER_BETPOS_ERROR                                   = 3079;                     // --该位置不可以下注~请重新选择

        BIND_GAMENO_ERROR                                   = 3080;                     //绑定场次错误
        GET_TABLELIST_ERROR                                 = 3081;                     //获取玩家列表错误
        TABLE_COIN_LIMIT                                    = 3082;                     //进入该房间金币最低限制是
        USER_BET_AGAIN_ERROR                                = 3083;                     //玩家上一轮没有投注
        USER_UNDO_BET_ERROR                                 = 3084;                     //没有可撤回的操作

        GAME_START_ERROR									= 3061;						// 牌桌已经开始
        USER_IP_SAME										= 3075;						// 该房间限制同IP加入，请联系房主！
        TABLE_NO_POSITION									= 3009;						// 此房间已经人满
      
        
        USER_AUTO_ERROR										= 3306;						// 先取消托管
        COIN_ENOUGH                                         = 3063;                     // 金币不足

        FORCEOFFLINE                                        = 30001;                    // 账号在其他地方登录,连接断开,请重新登录
        USERBAN                                             = 30002;                    // 账号异常...无法开始游戏,请联系客服
        NO_RECHARGE_ERROR                                   = 30923;                    // --请充值后,再进行操作
    }
    ErrorCode error                     = 1;// [default = NO_ERROR];   // 表示本次请求状态
    int64 serverTime                    = 2;                        // 服务器时间
    Request.CMD     cmd                 = 3;                        // 接口
 
    Reply ret                           = 4;

    S2C_Bet sendBet		                    = 11;						
    S2C_JoinTable sendJoinTable			    = 12;										
    S2C_NoticePush sendNoticePush	        = 13;						
    S2C_Reconnect sendReconnect			    = 14;						
    S2C_UserOnback sendUserOnback		    = 15;			
    S2C_UserQuit sendUserQuit		        = 16;
    S2C_UserExit sendUserExit               = 17;
    S2C_PushReconnectData pushReconnData    = 18;
    S2C_DelayQuitOffline  pushDelayQuit     = 19;
    S2C_GetTableList      sendTableList     = 20;
    S2C_FreeHands         sendFreeHands     = 21;
    S2C_DealCard          sendDealCard      = 22;
    S2C_UndoBet           sendUndoBet       = 23;
    S2C_ResetSubTable     sendResetSubTable = 24;
    S2C_GetSpecialCard    sendSpecialCard   = 25;

    //extensions 500 to 1000;
}