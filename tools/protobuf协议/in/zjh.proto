syntax = "proto3";
package zjh;

// UserState
 /**
    未准备
    NOREADY(0),
    准备
    READY(1),
    游戏中
    PLAY(2),
    ACCOUNT(3);
*/

// TableState
/**
等待状态 0(只在第一回合前有)
WAIT(0),
游戏中
PLAY(2),
结算 4
ACCOUNT(3);
*/

// type - pattern
/*
int PATTERN_baozi = 6;// 豹子
int PATTERN_tonghuashun = 5;// 同花顺
int PATTERN_tonghua = 4;// 同花
int PATTERN_shunzi = 3;// 顺子
PATTERN_duizi = 2;// 对子
PATTERN_gaopai = 1;// 高牌
*/

// 统一回复数据格式
message Reply
{
    int32 code = 1;
    string msg = 2;
}

message GameInfo
{
    int32 bpsbk         = 1;                // 比牌双倍开
    int32 bzewj         = 2;                // 豹子额外奖
	int32 fdkp          = 3;                // 封顶开牌(0:5轮,1:10轮,2:15轮)
	int32 bpls          = 4;                // 比牌轮数(0:3轮,1:10轮,2:15轮)
    int32 mpls          = 5;                // 闷牌轮数(0:不闷,1:2轮,2:3轮,3:5轮)
    int32 bottomBet     = 6;                // 底分 跟 difen 一样 (类型不一样)
    int32 koupaiCount   = 7;                // 扣牌张数(0:扣1张,1:两张,2:全扣)
    double difen        = 8;                // 底分
    int32 tableType     = 9;                // 跟 加入桌子的 入参 tabletype 一样
    int32 gameType      = 10;               // /** 游戏类型0:金币换桌模式,1:金币开房模式 */
}

message Player
{
    int32 userId = 1;
    string nickName = 2;
    string headImg = 3;
    int32 sex = 4;
    string ip = 5;
    double currentScore = 6;                    // 抽水后输赢
    repeated int32 remainCards = 7;             // 玩家手牌
    int32 pattern = 8;                          // 手牌牌型 具体见文件头 type 
    int32 seeCardState = 9;                     // 0:未看牌,1:已看牌
    int32 disCardState = 10;                    // 0:未弃牌,1:已弃牌
    int32 compareState = 11;                    // 0:没有输,1:比牌输
    repeated int32 betRecord = 12;              // 用户下注记录
    int32 userBetCoin = 13;                     // 用户该回合下注的总金额 
    int32 state = 14;                           // 见文件头 UserState 定义
    int32 onLine = 15;                          // 0：没掉线；1：掉线了
    int32 exit = 16;                            // 0：没离开；1：离开了
    double coin = 17;
    int32 genCoin = 18;                         // 看着计算方式，完全不知道用来干嘛
    int32 position = 19;

    int32 bonus = 31;                           // 奖池奖金
    int32 score = 32;                           // 抽水前输赢
    double startScore = 33;
    double endScore = 34;

     double totalScore = 35;                     // 本局总输赢
}

message TableInfo
{
    string tableId = 1;      
    int32 owner = 2;                            // 真实玩家userid 
    int32 zhuangPos = 3;                        // 庄家位置
    int32 state = 4;                            // 见文件头 UserState 定义
    int32 currentGameRound = 5;                 // 当前一回合中游戏轮数
    int32 tableBetCoin = 6;                     // 桌子上的下注金额
    int32 nextOpePos = 7;                       // 下一个操作者位置
    repeated int32 nextOpeBetCoin = 8;          // 下一个操作者可下注金额
    repeated int32 allBetCoin = 9;              // 下一个操作者可下注金额[1...len]
    GameInfo gameInfo = 10;                     // 游戏基础配置
    repeated Player users = 11;
    int64 startApplyTime = 12;
    string seq = 13;
}

/* ------------------------------------------------------------- *
 * ------------------------------------------------------------- *
 * -------------  如果发生错误则会回复 Reply 结构  --------------- *
 * ------------------------------------------------------------- *
 *---------------------------------------------------------------*/

// 此游戏未注册消息 但是包含此消息实现
// 消息类                    消息号                                    注册此消息游戏
// BindGameNoHandler        BIND_GAME_NO_HANDLER =2002                  骰宝
// GetAllUserHandler        GETUSERLIST_REQ = 2020                      奔驰宝马，龙虎，飞禽走兽
// GetRomeListHandler       GET_ROME_LIST = 20004                       三公，十三水，骰宝

// common 层消息
// 检测客户端延迟

// 后台来的强制踢出用户
// 大厅踢出
// ADMIN_KICKEDOUT = 200
message c2s_adminKickedOut
{
    int32 userId = 1;
}


// 非异常回复 PUSH_KICKEDOUT = 4001
message s2c_adminKickedOut
{
    string desc = 1;
}

// 后台通知金币？
// 通知客户端刷新金币
// HALL_REFRESH_COIN = 100
message c2s_refreshCoin
{
    int32 userId = 1;
    int32 type = 2;
    double coin = 3;
}


// PUSH_REFRESH_COIN = 2501
message s2c_refreshCoin
{
    int32 userId = 1;
    double coin = 2;
    bool isInTable = 3;  
    double addCoin = 4;
}

//超时退出..
// DELAYQUIT_OFFLINE_RESP = 3003;
message s2c_delayQuitOffline
{
    int32 userId = 1;
}

// PUSH_TABLE_INFO_RESP = 2009;
message s2c_pushTableInfo
{
    TableInfo tableInfo = 1;
}

/** 推送延时时间 */
// PUSH_REMAINTIME_RESP = 20015;
message s2c_pushRemainTime
{
    int32 time = 1;
    int32 type = 2;   
    int32 userId = 3;
}

// BET_REQ = 2020;
message c2s_bet
{
    int32 betCoin = 1;        // 下注金额
}

// BET_RESP = 2021;
message s2c_bet
{
    TableInfo tableInfo = 1;
    int32 userId = 2;
    int32 isAddBet = 3;
    int32 userBetCount = 4;
    int32 betCoin = 5;        // 下注金额
}

// PUSH_ROUND_RESULT_RESP = 2015
message s2c_roundResult
{
    TableInfo tableInfo = 1;
    string time = 2;
    bool noCoin = 3;
    int32 bankerRes = 4;            // 不确定是什么东西 因为是json串
    int32 winnerId = 5;
}

// JOIN_TABLE_REQ = 20006
message c2s_joinTable
{
    string sid= 1;
    int32 tableType = 2;
}

// JOIN_TABLE_RESP = 20007
message s2c_joinTable
{
    TableInfo tableInfo = 1;
    int32 userId = 2;
}

    /**用户点击比牌*/
// COMPARE_REQ = 2026;
message c2s_compareCard
{
    int32 otherId = 1;
}   

// COMPARE_RESP = 2027;
message s2c_compareCard
{
    TableInfo tableInfo = 1;
    int32 winnerId = 2;
    int32 loserId = 3;
    int32 userId = 4;
    int32 otherId = 5;
    bool isLast = 6;
}

    /**用户点击弃牌*/
// DISCARD_REQ = 2024;
message c2s_disCard
{

}
// DISCARD_RESP = 2025;
message s2c_disCard
{
    int32 userId = 1;
    TableInfo tableInfo = 2;
}

	/** 玩家一直跟注*/
// FOLLOWER_BET_REQ = 2084;
message c2s_followerBet
{
    bool isfollow = 1;
}
// FOLLOWER_BET_RESP = 2085;
message s2c_followerBet
{

}

// PUSH_USER_RECONNECT_REQ = 2030;
message c2s_reconnect
{
    int32 userId = 1;
}

// PUSH_USER_RECONNECT_RESP = 2031
message s2c_reconnect
{
    int32 userId = 1;
    int32 online = 2;
}

// PUSH_RECONNECT_DATA_RESP = 2033 重连数据
message s2c_reconnectData
{
    TableInfo tableInfo = 1;
}

// PUSH_RECONNECT_QUIT_RESP = 2035 房间不存在发送此消息号 ------- 返回大厅
message s2c_pushReconnectQuit
{
    int32 userId = 1;
}

    /**玩家点击看牌请求 2022*/
// SEECARD_REQ = 2022;
message c2s_seeCard
{

}

    /**玩家看牌返回 2023*/
// SEECARD_RESP = 2023;
message s2c_seeCard
{
    int32 userId = 1;
    TableInfo tableInfo = 2;
}


	/** 发送聊天消息 */
// SEND_MESSAGE_REQ = 2060;
message c2s_sendSpeech
{
    int32 toUserId = 1;
}
// SEND_MESSAGE_RESP = 2061;
message s2c_sendSpeech
{
    int32 userId = 1;
    int32 toUserId = 2;
}

/** 用户退后台 */
// USER_ONBACK_REQ = 2080;
message c2s_userOnback
{
    int32 leaveState = 1;
}

// USER_ONBACK_RESP = 2081
message s2c_userOnback
{
    int32 userId = 1;
}

// USER_QUIT_REQ = 2044;
message c2s_userQuit
{

}
// USER_QUIT_RESP = 2045
message s2c_userQuit
{
    int32 userId = 1;
    string nickName = 2;
    int32 position = 3;
    string  tableId = 4;
    string msg = 5;
    int32 exit = 6;
}

// USER_READY_REQ = 2106;
message c2s_userReady
{
    int32 tableType = 1;
}

    /** 玩家点击准备返回 2107 */
    //给客户端播放刷新匹配时间动画
// USER_READY_RESP = 2107
message s2c_userReady
{
    TableInfo tableInfo = 1;
}


// SETCARDSTEST = 20000;
message c2s_setCardsTest
{
    int32 gameId = 1;           // gameid
    int32 tabletype = 2;        // 房间类型
    int32 deskNo = 3;           // 座位号
    string sendData = 4;        // 发送配置。 牌面值为 花色值*16+牌面值 ，用逗号分割
    string extraData = 5;
}


//所有请求接口
message Request {
    enum CMD 
    {
        UNKNOWN                             = 0;

          /**后台手动踢出用户*/
        ADMIN_KICKEDOUT = 200;

            /**玩家下注 请求2020*/
        BET_REQ = 2020;
    /**玩家下注 返回2021*/
        BET_RESP = 2021;

        // 加入桌子
        JOIN_TABLE_REQ = 20006;
        JOIN_TABLE_RESP = 20007;

            /**用户点击比牌*/
        COMPARE_REQ = 2026;
        COMPARE_RESP = 2027;

            /**用户点击弃牌*/
        DISCARD_REQ = 2024;
        DISCARD_RESP = 2025;

        	/** 玩家一直跟注*/
	    FOLLOWER_BET_REQ = 2084;
	    FOLLOWER_BET_RESP = 2085;

        // 重连
        PUSH_USER_RECONNECT_REQ = 2030;
        PUSH_USER_RECONNECT_RESP = 2031;
        PUSH_RECONNECT_QUIT_RESP = 2035;            // 房间不存在发送此消息号 ------- 返回大厅
        PUSH_RECONNECT_DATA_RESP = 2033;            // 重连数据


            /**玩家点击看牌请求 2022*/
        SEECARD_REQ = 2022;
        /**玩家看牌返回 2023*/
        SEECARD_RESP = 2023;

        	/** 发送聊天消息 */
	    SEND_MESSAGE_REQ = 2060;
	    SEND_MESSAGE_RESP = 2061;

        /** 用户退后台 */
        USER_ONBACK_REQ = 2080;
        USER_ONBACK_RESP = 2081;

        // 玩家退出
        USER_QUIT_REQ = 2044;
        USER_QUIT_RESP = 2045;
    
        // 玩家准备
        USER_READY_REQ = 2106;
        USER_READY_RESP = 2107;

        //结算
        PUSH_ROUND_RESULT_RESP = 2015;


        PUSH_KICKEDOUT = 4001;

        

           /**强制踢出*/
        FOUCED_OFFLINE_RESP = 3001;

        /**刷新游戏金币*/ // 接受
        HALL_REFRESH_COIN = 100;

        //通知刷新金币    // 推送
        PUSH_REFRESH_COIN = 2501;

        DELAYQUIT_OFFLINE_RESP = 3003;

        PUSH_TABLE_INFO_RESP = 2009;                    // 游戏开始返回

        /** 推送延时时间 */
        PUSH_REMAINTIME_RESP = 20015;

        // 测试牌 协议
        SETCARDSTEST = 20000;
    }

    CMD   cmd                               = 1;      //访问接口	
    c2s_bet bet                   		    = 11;     
    c2s_joinTable joinTable		            = 12;  
    c2s_compareCard compareCard             = 13;
    c2s_disCard disCard                     = 14;
    c2s_followerBet followerBet             = 15;	 
    c2s_reconnect reconnect				    = 16;	
    c2s_seeCard seeCard                     = 17;
    c2s_sendSpeech sendSpeech               = 18;
    c2s_userOnback userOnback			    = 19;	  
    c2s_userQuit userQuit				    = 20;	  
    c2s_userReady userReady                 = 21;

    // 
    c2s_refreshCoin refreshCoin             = 23;
    c2s_adminKickedOut adminKickedOut       = 24;
    c2s_setCardsTest setCardsTest           = 25;
	//extensions 500 to 1000;
}

//所有应答接口
message Response {
    enum ErrorCode {
        NO_ERROR                        = 0;       
        OK                                                  = 200;                      // "OK",
        DATA_PARSE_ERROR                                    = 31000;                    // "pb数据解析错误")
        TABLE_NOT_FIND_ERROR								= 3008;						// --牌桌不存在 
        NOT_IN_TABLE										= 3011;						// --未加入此房间
        BET_POS_ERROR                                       = 3072;                     // 下注位置异常"),
        JOIN_TABLE_ERROR                                    = 3007;                     // 加入牌桌失败
        ROOMLIST_ERROR                                      = 3091;                     // 加载房间列表失败
        CHANNELID_GAMENO_ERROR                              = 3003;                     // channelId或gameNo错误
        ACCOUNT_NOT_ENOUGH_ERROR                            = 3006;                     // "余额不足"),
        NO_RECHARGE_ERROR                                   = 30923;                    // --请充值后,再进行操作
        USERBAN                                             = 30002;                    // 账号异常...无法开始游戏,请联系客服
        COMPARE_VALID_ERROR                                 = 3080;                     // "比牌失败,无效的操作"),
        COMPARE_POS_ERROR                                   = 3079;                     // "比牌失败,没有轮到该玩家操作"),
        COMPARE_ROUND_ERROR                                 = 3081;                     // "比牌失败,比牌轮数未到")
        QICARD_REPEAT_ERROR                                 = 3076;                     // "弃牌失败,已经弃过牌了")
        QICARD_ERROR                                        = 3075;                     // "弃牌失败")
        USER_NOT_FOUND_ERROR                                = 3005;                     // 玩家不存在 
        FOUCEDOFFLINE                                       = 30001;                    // 账号在其他地方登录,连接断开,请重新登录
        SEECARD_REPEAT_ERROR                                = 3074;                     // "看牌失败,已看过牌")
        SEECARD_ROUND_ERROR                                 = 3082;                     // "看牌失败,闷牌轮数未到")
        NOT_ALLOW_QUIT										= 3014;						// 无法退出房间
        TABLE_NO_POSITION                                   = 3009;                     // "此房间已经人满")
        BET_COIN_ERROR                                      = 3071;                     // "下注金额异常")
        QICARD_POS_ERROR                                    = 3077;                     // "弃牌失败,还没轮到玩家操作")
        QICARD_NOT_SEE_CARD_ERROR                           = 3200;                     // 看牌之前不能弃牌      
        USER_BET_STATE_ERROR                                = 3201;                     // "还未轮到你下注，请稍等"),      
        TESTE   = 1010010;
    }
    ErrorCode error                             = 1;            // [default = NO_ERROR];   // 表示本次请求状态
    int64 serverTime                            = 2;                        // 服务器时间
    Request.CMD     cmd                         = 3;                        // 接口
 
    Reply ret                                   = 4;

    s2c_bet sendBet		                        = 11;	
    s2c_joinTable sendJoinTable                 = 12;
    s2c_compareCard sendCompareCard             = 13;
    s2c_disCard sendDisCard                     = 14;
    s2c_followerBet sendFollowerBet             = 15;						
    s2c_reconnect sendReconnect			        = 16;	
    s2c_reconnectData sendReconnectData         = 17;
    s2c_pushReconnectQuit sendReconnectQuit     = 18;
    s2c_seeCard sendSeeCard                     = 19;
    s2c_sendSpeech  sendSpeech                  = 20;
    s2c_userOnback sendUserOnback		        = 21;			
    s2c_userQuit sendUserQuit		            = 22;						
    s2c_userReady sendUserReady                 = 23;
    s2c_roundResult sendRoundResult             = 24;


    s2c_refreshCoin sendRefreshCoin             = 25;
    s2c_delayQuitOffline sendDelayQuitOffline   = 26;
    s2c_pushTableInfo sendpushTableInfo         = 27;
    s2c_pushRemainTime sendPushRemainTime       = 28;
    s2c_adminKickedOut sendAdminKickedOut       = 29;
 
    //extensions 500 to 1000;
}