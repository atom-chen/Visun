syntax = "proto3";
package qznn;

/*********************  基础对象 ************************/

message OutCard {
      repeated int32 cardThree             = 1;
      repeated int32 cardTwo               = 2;
      int32 type                  = 3; //0:没牛； 1：牛一 ~10：牛牛；11：四花牛；12：五花牛；13：炸弹；14：五小牛
  }
  
  message UserCards {
       repeated int32 remainCards         = 1;
  }
  
  
  message User{
        int32 userId                = 1; //用户ID
        int32 state                 = 2; //状态 
        string nickname             = 4;
        string headImg              = 5;
        int32 sex                   = 6;
        string ip                   = 7;
        int32 position              = 8;
        int32 agree                 = 10;
        int32 onLine                = 11;
        double coin                  = 12;
        
        int32 betCoin               = 13;
        int32 qiang                 = 14; //抢庄
        
        repeated int32 remainCards           = 15;
        OutCard bestOutCardDto      = 16;
        
        repeated int32 allowQiang            = 17;
        repeated int32 allowBet              = 18;
        double currentScore          = 19;
    
        OutCard outCardDto          = 20;
        UserCards cards                 = 21;
        int32 score                 = 22;
        double revenue               = 23;
        double startScore            = 24;
        double endScore              = 25;
        bool hasShowCard			 = 26;
          double totalScore           = 27;
    }
  
  
  /*********************  请求对象 ************************/
  
  //用户准备
  // USER_READY				   = 2106
  message UserReadyRequest{
        int32  tableType            = 1;
  }
  
  
  
  //下注
  // BET                          = 2012
  message BetRequest {
     int32 betCoin               = 1; // 
  }
  
  
  //亮牌
  // SHOW_CARD                    = 2010
  message ShowCardRequest {
  
  }
  
  //玩家退出
  // USER_QUIT                    = 2044
  message UserQuitRequest {
  
  }
  
  
  //退到后台
  // USER_ONBACK                  = 2080
  message UserOnBackRequest {
        int32 leaveState       = 1;
        int32 userId           = 2; //
  }
  
  //延时检测
  // DELAY_CHECK                  = 20010
  message DelayCheckRequest {
        string content          = 1;//内容
  }
  
  //重连 
  // USER_RECONNECT               = 2030
  message UserReconnectRequest {
        int32 userId            = 1; //   
  }
  
  //抢庄
  // QIANG_ZHUANG                 = 2024
  message QiangZhuangRequest {
       int32 qiang              = 1; //
  }
  
  
  //换桌
  // CHANGE_TABLE                 = 20004
  message ChangeTableRequest {
       
  }
  
  //加入金币场
  // COIN_JOIN_TABLE              = 20006
  message CoinJoinTableRequest {
       string sid               = 1; //
       int32 tableType          = 2;
  }
  
  //聊天
  message MessageRequest {
        string content          = 1;//聊天内容
        int32 toUserId          = 2;//目标用户（0表示自己） 
  }
  
  //  KICKEDOUT                    = 4001
  message KickedOutRequest{
      int32 userId    = 1;
  }
  
  message KickedOutResponse{
      string desc     = 1;
  }
  
  message NoticePushFrCenterRequest{
      string content              = 1;
  }
  
  message NoticePushFrCenterResponse{
      string content          = 1;
  }
  
  message HallRefreshCoinRequest{
      int32 userId    = 1;
      int32 type      = 2;
  }
  
  message HallRefreshCoinResponse{
      int32 userId        = 1;
      double coin         = 2;
      bool isInTable      = 3;
  }
  
  //推送金币刷新
  message SendCoinRefreshResponse {
        int32 userId            = 1;
        double coin             = 2;
        bool isInTable          = 3;
        bool type               = 4;
        int32 addCoin           = 5;
  }
  
  // SETCARDSTEST = 20000;
  message SetCardsTest
  {
      int32 gameId = 1;
      int32 tabletype = 2;
      int32 deskNo = 3;
      string sendData = 4;
      string extraData = 5;
  }
  
  //配牌返回
  message S2C_SetGameData
  {
      string data  = 1;
  }
  
  //所有请求接口
  message Request {
      enum CMD {
        UNKNOWN                      = 0;
        COIN_JOIN_TABLE              = 40000;  //加入金币场 CoinJoinTableRequest
        COIN_JOIN_TABLE_RESP         = 40001;  //加入金币场返回 CoinJoinTableResponse
        HALL_REFRESH_COIN            = 40002;  //HallRefreshCoinRequest, HallRefreshCoinResponse
        USER_READY				   = 40003;  //玩家信息展示 UserReadyRequest, UserReadyResponse
        BET                          = 40004;  //下注  BetRequest, BetResponse
        SHOW_CARD                    = 40005;  //亮牌 ShowCardRequest, ShowCardResponse
        QIANG_ZHUANG                 = 40006;  //抢庄 QiangZhuangRequest, QiangZhuangResponse
        CHANGE_TABLE                 = 40007;  //换桌 ChangeTableRequest
        MESSAGE                      = 40008;  //聊天 MessageRequest
        USER_QUIT                    = 40009;  //玩家退出 UserQuitRequest, UserQuitResponse
  
        USER_ONBACK                  = 40010;  //用户退到后台  UserOnBackRequest
        DELAY_CHECK                  = 40011;  //客户端延时检测  DelayCheckRequest, DelayCheckResponse
        USER_RECONNECT               = 40012;  //玩家重连 UserReconnectRequest, UserReconnectResponse
        
        SEND_USER_INFO               = 40013;  //推送玩家信息 TableInfoResponse
        SEND_USER_CARD               = 40014;  //推送玩家手牌 TableInfoResponse
        SEND_ZHUANG                  = 40015;  //推送庄家信息   TableInfoResponse
        
        SEND_ROUND_RESULT            = 40016;  //推送回合结算 SendRoundResultResponse
        SEND_REMAIN_TIME             = 40017;  //推送延时 SendRemainTimeResponse
        SEND_GAME_NOTICE             = 40018;  //推送公告 SendGameNoticeResponse
        SEND_LEAVE_TABLE			   = 40019;  //推送玩家离开桌子 SendLeaveTableResponse
  
        SEND_USER_RECONNECT          = 40020;  //推送重连信息 SendUserReconnectResponse
        SEND_RECONNECT_QUIT          = 40021;  //玩家重连回到大厅 SendReconnectQuitResponse
        SEND_MESSAGE                 = 40022;  //推送聊天信息 SendMessageResponse
        SEND_COIN_REFRESH            = 40023;  //推送金币刷新 SendCoinRefreshResponse
        
        SEND_USER_ONBACK             = 40024;  //退到后台 SendUserOnBackResponse
        FORCE_OFFLINE                = 40025;  //
        SEND_HEART_BEAT              = 40026;  //推送心跳 SendHeartBeatResponse
        KICKEDOUT                    = 40027;  //KickedOutRequest,KickedOutResponse
        SEND_COIN_TABLE_INFO         = 40028;  //玩家中途加入游戏时推送当前桌子信息 SendCoinTableInfoResponse
        NOTICE_PUSH_RESP             = 40029;
        SETCARDSTEST                 = 40030;  //配牌 C2S_SetGameData S2C_SetGameData
      }
  
      CMD   cmd                                      = 1;      //访问接口
      UserReadyRequest userReadyRequest  	           = 11;	 //用户准备
      UserQuitRequest userQuitRequest                = 17;     //玩家退出
      MessageRequest messageRequest                  = 22;     //聊天
      DelayCheckRequest delayCheckRequest            = 23;     //延时检测
      UserReconnectRequest userReconnectRequest      = 24;     //重连
      BetRequest betRequest                          = 25;     //下注
      ShowCardRequest showCardRequest                = 26;     //
      QiangZhuangRequest qiangZhuangRequest          = 27;     //抢庄
      ChangeTableRequest changeTableRequest          = 28;     //换桌
      CoinJoinTableRequest coinJoinTableRequest      = 29;     //
      UserOnBackRequest userOnBackRequest            = 30;     //
      KickedOutRequest kickedOutRequest              = 31;
      NoticePushFrCenterRequest noticePushFrCenterRequest = 32;
      HallRefreshCoinRequest hallRefreshCoinRequest  = 33;
      SetCardsTest setCardsTest                      = 34;
  }
  
  
  
  /*********************  返回数据 ************************/
  
  
  
  //玩家信息获取
  message UserReadyResponse {
       int32 userId             = 1; //用户ID
       string tableId           = 2;
       int32 owner              = 3;
       int32 state              = 4; //状态  
       string gameInfo          = 5;
       int32 gameId             = 6;
       repeated  User  users             = 7; //其它用户状态信息
  }
  
  
  
  
  //用户下注
  message BetResponse {
       int32 userId             = 1;
       int32 state              = 2;
       repeated User users               = 3;
  }
  
  //亮牌
  message ShowCardResponse {
        int32 userId            = 1;
        int32 state             = 2;
        OutCard outCardDto      = 3;
  }
  
  
  //抢庄
  message QiangZhuangResponse {
       int32 userId             = 1;
       int32 state              = 2;
       repeated User users               = 3;
  }
  
  
  //退出--消息
  message UserQuitResponse {
        int32 userId           = 1;
        string nickname        = 2;
        int32 position         = 3;
        string message         = 4;
        string tableId         = 5;
  }
  
  
  //推送总结算
  message SendGameOverResponse {
        int32 state             = 1;
        int32 owner             = 2;
        int32 totalRound        = 3;
        int32 currentRound      = 4;
        string time             = 5;
        repeated User users              = 6;
  }
  
  //推送重连信息
  message SendUserReconnectResponse {
        int32 userId            = 1;
        int32 onLine            = 2;
  }
  
  //重连
  message UserReconnectResponse {
        string tableId           = 1;
        int32 gameId             = 2;
        int32 state              = 3;
        int32 owner              = 4;
        string gameInfo          = 5;
        int32 applicant          = 6;
        int32 applyTime          = 7;
        int64 startApplyTime     = 8;
        int32 zhuangPos          = 9;
        int32 remainCardsNum     = 10;
        string seq               = 11;
        
        repeated User users               = 20;
  }
  
  
  message TableInfoResponse {
       string tableId           = 1;
       int32 owner              = 2;
       int32 state              = 3;
       int32 zhuangPos          = 4;
       string gameInfo          = 5;
       string seq               = 6;
       
       repeated User users               = 20;  
  }
  
  
  //玩家重连回到大厅
  message SendReconnectQuitResponse {
        int32 userId            = 1;
  }
  
  
  //推送钻石变化
  message SendDiamondChangeResponse {
        int32 userId            = 1;
        int32 diamond           = 2;
  }
  
  //退到后台
  message SendUserOnBackResponse {
        int32 userId            = 1;
        int32 leaveState        = 2;
  }
  
  
  
  message DelayCheckResponse {
        string content          = 1;
  }
  
  //心跳
  message SendHeartBeatResponse {
        int64 currentTime       = 1;
  }
  
  //玩家中途加入游戏时推送当前桌子信息
  message SendCoinTableInfoResponse {
       string tableId           = 1;
       int32 gameId             = 2;
       int32 state              = 3;
       int32 owner              = 4;
       string gameInfo          = 5;
       int32 applicant          = 6;
       int32 applyTime          = 7;
       int64 startApplyTime     = 8;
       int32 zhuangPos          = 9;
       int32 remainCardsNum     = 10;
  
       repeated User users               = 11;
  }
  
  
  message CoinJoinTableResponse {
       string tableId           = 1;
       int32 owner              = 2;
       int32 state              = 3; //状态  
       string gameInfo          = 4;
       int32 gameId             = 5;
       repeated  User  users             = 6; //其它用户状态信息
  }
  
  //发送聊天信息
  message SendMessageResponse {
        int32 userId            = 1;
        string content          = 2;
        int32 toUserId          = 3;
  }
  
  
  //回合结算--推送消息
  message SendRoundResultResponse {
       int32 state              = 1; 
       string gameInfo          = 2;
       int32 zhuangPos          = 3;
       string time              = 4;
       bool noCoin              = 5;
       bool isAuto              = 6;
       repeated User users               = 7;
  }
  
  
  message SendRemainTimeResponse {
       int32 time               = 1;
       int32 type               = 2;
       int32 totalTime          = 3;
  }
        
  
  //推送公告
  message SendGameNoticeResponse {
        string notice           = 1;
  }
  
  //推送公告
  message SendLeaveTableResponse {
        int32 userId           = 1;
  }
  //所有应答接口
  message Response {
      enum ErrorCode {
          NO_ERROR                                            = 0;                        // 返回没有错误发生  
          USER_READY_ERROR                                    = 3010;                     // 玩家准备异常
          TABLE_NOT_FIND_ERROR                                = 3008;                     // 牌桌不存在
          NOT_IN_TABLE                                        = 3011;                     // 未加入此房间
          ACCOUNT_NOT_ENOUGH                                  = 3006;
          JOIN_TABLE_ERROR                                    = 3007;                     // 加入牌桌失败
          TABLE_NO_POSITION                                   = 3009;                     // 此房间已经人满
       
          USER_QUIT_ERROR                                     = 3013;                     // 玩家退出异常
          NOT_ALLOW_QUIT                                      = 3014;                     // 无法退出房间
         
          WAITING_RESPONSE                                    = 3043;                     // 等待其他玩家响应
          USER_MP_ERROR                                       = 3200;                     // 明牌失败
        
          TABLE_HASSTART_POSITION                             = 3071;                     // 此房间游戏已开始
          RECONNET_ERROR                                      = 3025;                     // 重连错误
          SEND_MESSAGE_ERROR                                  = 3040;                     // 发送信息失败
          USER_ONBACK_ERROR                                   = 3056;                     // 用户退后台消息
          DELAY_CHECK_ERROR                                   = 3201;                     // 延时检测异常
          RE_JOIN_TABLE_ERROR                                 = 3026;                     // 重新加入桌子失败
          USER_BET_ERROR                                      = 3077;                     // 用户下注失败
          USER_SHOWCARD_ERROR                                 = 3076;                     // 用户亮牌失败
          QIANG_ZHUANG_ERROR                                  = 3075;                     // 抢庄
          USER_CHANGE_TABLE_ERROR                             = 3069;                     // 玩家换桌异常
          ROOM_LIST_ERROR                                     = 3091;
          USER_CHANGE_TABLE_STATE_ERROR                       = 3070;                     //玩家该状态下不能换桌
          USER_NOT_FOUND_ERROR                                = 3005;                     //玩家不存在
          CHANNELID_GAMENO_ERROR                              = 3092;                     //
          USER_QUIT_FOR_OVERTIME_ERROR                        = 3093;                     //您已经长时间没有操作，已退出游戏房间
          USER_BAN                                            = 30002;                    //账号异常...无法开始游戏,请联系客服
          FORCED_OFFLINE                                      = 30001;                    //账号在其他地方登录,连接断开,请重新登录
          NO_RECHARGE_ERROR                                   = 30923;
          PUSH_USER_TESTDATA_ERROR                            = 500;                      // 配牌失败
      }
      ErrorCode error                                = 1 ;   // 表示本次请求状态
      int64 serverTime                               = 2;                        // 服务器时间
      Request.CMD     cmd                            = 3;                        // 接口
      UserReadyResponse userReadyResponse	    	= 11;                       //玩家信息获取
      UserQuitResponse userQuitResponse              = 18;                       //玩家退出消息
      SendUserReconnectResponse sendUserReconnectResponse  = 27;                 //推送重连信息
      SendReconnectQuitResponse sendReconnectQuitResponse  = 28;                 //
  
      SendUserOnBackResponse sendUserOnBackResponse  = 31;                       //退到后台
    
      DelayCheckResponse delayCheckResponse          = 33;                       //延时检测
      UserReconnectResponse userReconnectResponse    = 34;                       //重连
      SendHeartBeatResponse sendHeartBeatResponse    = 35;                       //心跳
      BetResponse betResponse                        = 36;                       //下注
      ShowCardResponse showCardResponse              = 37;                       //亮牌
      QiangZhuangResponse qiangZhuangResponse        = 38;                       //抢庄
      SendCoinTableInfoResponse sendCoinTableInfoResponse   = 39;                // 
      CoinJoinTableResponse coinJoinTableResponse    = 40;                       //  
      SendMessageResponse sendMessageResponse        = 41;                       //发送消息
      TableInfoResponse tableInfoResponse            = 42;                       //推送用户信息
      SendRoundResultResponse sendRoundResultResponse       = 43;                //
      SendRemainTimeResponse sendRemainTimeResponse  = 44;                       //推送延时
      SendGameNoticeResponse sendGameNoticeResponse  = 45;                       //推送公告
      SendLeaveTableResponse sendLeaveTableResponse	= 46;						//离开桌子
      KickedOutResponse kickedOutResponse                                 = 47;
      NoticePushFrCenterResponse noticePushFrCenterResponse               = 48;
      HallRefreshCoinResponse hallRefreshCoinResponse                     = 49;
  }
  
  